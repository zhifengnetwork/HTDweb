<!DOCTYPE HTML>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<title>上传身份证</title>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<script src="../js/public/rem.js"></script>
		<link rel="stylesheet" href="../css/my/upIDCard.css" />
		<link rel="stylesheet" href="../css/public/reset.css" />
		<link rel="stylesheet" href="../css/public/base.css" />
	</head>

	<body style="max-width: 750px;">
		<!-- 头部 -->
		<div class="header-zp">
			<span class="return" onclick="returnFun()"><img src="../image/public/return-zp@2x.png" /></span>
			<h3>上传身份证</h3>
		</div>

		<section class="acc_apply">
			<ul>
				<li style="border-top: 0; margin-bottom: 60px;">
					<div class="acc_img">
						<p class="tc">身份证正面</p>
						<div id="sss">
							<!--<img class="acc_imgin" src="../image/home/acc_img.png" id="img0">-->
							<img class="acc_imgin preViewImg" src="../image/home/acc_img.png" id="img0"/>
						</div>
						<div class="acc_sc">
							<a href="javascript:;" class="tc acc_scicon">选择图片</a>
							<!--上传图片 tyle='file'-->
							<input class="ph08" type="file" onchange="UpLoad(this)" name="file" id="file0" value="" accept="image/*" hidden />
							<!--<input type="file" name="file0" id="file0" class="ph08" accept="image/*" />-->
						</div>
						<!--<p class="ph09 ">注：身份证上的所有信息清晰可见，必须能看清证件号。照片需免冠，建议未化妆。手持证件人的五官清晰可见。照片内容真实有效。不得做任何修改。支持jpg、jpeg、bmp、gif格式照片。大小不超过5M</p>-->
					</div>
				</li>
				<li style="border-top: 0; margin-bottom: 60px;">
					<div class="acc_img">
						<p class="tc">身份证反面</p>
						<div id="sss">
							<img class="acc_imgin" src="../image/home/acc_img.png" id="img1">
						</div>
						<div class="acc_sc">
							<a href="javascript:;" class="tc acc_scicon">选择图片</a>
							<input type="file" name="file0" id="file1" class="ph08" accept="image/*" />
						</div>
						<!--<p class="ph09 ">注：身份证上的所有信息清晰可见，必须能看清证件号。照片需免冠，建议未化妆。手持证件人的五官清晰可见。照片内容真实有效。不得做任何修改。支持jpg、jpeg、bmp、gif格式照片。大小不超过5M</p>-->
					</div>
				</li>
			</ul>
		</section>
		
		<div class="lj_szmm_a">
			<a href="#">提交</a>
		</div>

		<script src="../js/public/jquery-1.8.3.min.js"></script>
		<script src="../js/public/base.js"></script>
		<!--000-->
		<script>
			/*上传图片 按钮  */
			function uploadImgBut(_index){
//				ind = _index;
//				/* 关联 '选择上传文件'的按钮 */
//				$(".uploadFile").eq(_index).trigger("click");
				return false;
			}
			
			/*上传图片*/
			function  UpLoad(e) { 
				console.log(9999)
				if(e.files[0]){
				    var f = e.files[0];  
				    fileType = f.type;  
				    if(/image\/\w+/.test(fileType)) {  
				        var fileReader = new FileReader();  
				        fileReader.readAsDataURL(f);  
				        fileReader.onload = function(event) {  
				            var result = event.target.result; //返回的dataURL   
				            var image = new Image();  
				            image.src = result;  
				            //若图片大小大于1M，压缩后再上传，否则直接上传  
				            if(f.size>1024*1024){     
				                    image.onload = function() { 
				                    //创建一个image对象，给canvas绘制使用
				                    var canvas = document.getElementById("canvas"); 
				                    canvas.width = image.width;  
				                    canvas.height = image.height; //计算等比缩小后图片宽高   
				                    var ctx = canvas.getContext('2d');  
				                    ctx.drawImage(this, 0, 0, canvas.width, canvas.height);  
				                    var newImageData = canvas.toDataURL(fileType, 0.8); //重新生成图片
	//			                       	sendData = newImageData.replace("data:"+fileType+";base64,",'');                  
	//			                    dataLength = decodeBase64(sendData).length;//base64位图片长度（这里没有写这个方法）                 
	//			                    $("#imgUrl").val(sendData);
	//			                    console.log(sendData);
				                    /*根据点击的下标 => 图片 回显*/
				                    $(".preViewImg").eq(ind).attr("src",newImageData); 
				                    console.log(newImageData);
				                     
				                    $("#canvas").hide();
				                    /*根据点击的下标 =>显示 '回显图片'*/
				                    $(".echoImages").eq(ind).show();
				                }  
				            }else{  
				            	//创建一个image对象，给canvas绘制使用 
				                image.onload = function() { 
	//				                sendData = result.replace("data:"+fileType+";base64,",'');  
	//				                console.log(sendData);
	//				                dataLength = decodeBase64(sendData).length;  
	
	//								console.log(result);
									/* 根据点击的下标 => 图片 回显 */
					                $(".preViewImg").eq(ind).attr("src",result);  
	//				                $("#imgUrl").val(sendData); 
					                /*根据点击的下标 =>显示 '回显图片'*/
					                $(".echoImages").eq(ind).show();
					                console.log(result);
				            	}  
				            }  
				        }  
				    } else {  
				        alert("请选择图片");  
				    }  
				    
			    }else {
			    	console.log('取消选择图片！')
			    }
			}  
		</script>
		<!--000-->
		<script>
			
			$(function() {
//				$(window).on("load", function() {
//					$("#loading").fadeOut();
//				})
//				$("#tip .pack a").on("click", function() {
//					$("#tip").fadeOut()
//					$("#tip .pack p").html("")
//					return false;
//				})

//				function alerths(str) {
//					$("#tip").fadeIn()
//					$("#tip .pack p").html(str)
//					return false;
//				}
//				$(".acc_sure").on("click", function() {
//					alerths("请等待审核！")
//					return false;
//				})
				/*文件上传1*/
				$("#file0").change(function() {
					if(this.files && this.files[0]) {
						var objUrl = getObjectURL(this.files[0]);
						console.log("objUrl = " + objUrl);
						if(objUrl) {
							$("#img0").attr("src", objUrl);
							$("#file0").click(function(e) {
								$("#img0").attr("src", objUrl);
								console.log(999,objUrl);
							});
						} else {
							this.select();
							var imgSrc = document.selection.createRange().text;
							var localImagId = document.getElementById("sss");
							try {
								preload.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = data;
							} catch(e) {
								this._error("filter error");
								return;
							}
							this.img.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src=\"" + data + "\")";
						}
					}
				});
				/*文件上传1*/
				$("#file1").change(function() {
					if(this.files && this.files[0]) {
						var objUrl = getObjectURL(this.files[0]);
						console.log("objUrl = " + objUrl);
						if(objUrl) {
							$("#img1").attr("src", objUrl);
							$("#file1").click(function(e) {
								$("#img1").attr("src", objUrl);
							});
						} else {
							this.select();
							var imgSrc = document.selection.createRange().text;
							var localImagId = document.getElementById("sss");
							try {
								preload.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = data;
							} catch(e) {
								this._error("filter error");
								return;
							}
							this.img.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src=\"" + data + "\")";
						}
					}
				});

				function getObjectURL(file) {
					var url = null;
					if(window.createObjectURL != undefined) {
						url = window.createObjectURL(file);
					} else if(window.URL != undefined) {
						url = window.URL.createObjectURL(file);
					} else if(window.webkitURL != undefined) {
						url = window.webkitURL.createObjectURL(file);
					}
					return url;
				}

			})
		</script>

	</body>

</html>